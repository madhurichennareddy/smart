<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Learning Academy</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      height: 100%;
      background-color: #0f172a;
      color: #f1f5f9;
    }

    html {
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .app-container {
      min-height: 100%;
      display: flex;
      flex-direction: column;
    }

    .hero-section {
      padding: 60px 24px;
      text-align: center;
    }

    .hero-title {
      font-size: 48px;
      font-weight: 800;
      margin: 0 0 16px 0;
      line-height: 1.2;
    }

    .hero-subtitle {
      font-size: 20px;
      opacity: 0.85;
      margin: 0 0 32px 0;
    }

    .start-button {
      padding: 16px 48px;
      font-size: 18px;
      font-weight: 700;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      background-color: #3b82f6;
      color: #ffffff;
    }

    .start-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
    }

    .stats-bar {
      padding: 24px;
      display: flex;
      justify-content: center;
      gap: 48px;
      flex-wrap: wrap;
      border-top: 2px solid #3b82f6;
    }

    .stat-item {
      text-align: center;
    }

    .stat-number {
      font-size: 32px;
      font-weight: 700;
      display: block;
      margin-bottom: 4px;
      color: #3b82f6;
    }

    .stat-label {
      font-size: 14px;
      opacity: 0.7;
    }

    .content-section {
      flex: 1;
      padding: 40px 24px;
      max-width: 1000px;
      margin: 0 auto;
      width: 100%;
    }

    .section-title {
      font-size: 28px;
      font-weight: 700;
      margin: 0 0 32px 0;
      text-align: center;
    }

    .lessons-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 24px;
    }

    .lesson-box {
      border-radius: 16px;
      padding: 32px 24px;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      text-align: center;
      border: 3px solid transparent;
      background-color: #1e293b;
    }

    .lesson-box:hover {
      transform: translateY(-6px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.2);
    }

    .lesson-box.completed {
      border-color: #10b981;
    }

    .lesson-emoji {
      font-size: 56px;
      margin-bottom: 16px;
      display: block;
    }

    .lesson-name {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .lesson-info {
      font-size: 14px;
      opacity: 0.8;
      margin-bottom: 16px;
    }

    .lesson-badge {
      display: inline-block;
      padding: 6px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      background-color: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
    }

    .lesson-badge.completed {
      background-color: rgba(16, 185, 129, 0.2);
      color: #10b981;
    }

    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 100;
      padding: 20px;
      overflow-y: auto;
    }

    .overlay.show {
      display: block;
    }

    .lesson-panel {
      max-width: 700px;
      margin: 40px auto;
      border-radius: 20px;
      padding: 40px;
      position: relative;
      background-color: #1e293b;
      color: #f1f5f9;
    }

    .close-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 44px;
      height: 44px;
      border: none;
      border-radius: 50%;
      font-size: 28px;
      cursor: pointer;
      transition: all 0.2s;
      line-height: 1;
      background-color: rgba(241, 245, 249, 0.15);
      color: #f1f5f9;
    }

    .close-btn:hover {
      transform: rotate(90deg);
      background-color: rgba(241, 245, 249, 0.25);
    }

    .panel-title {
      font-size: 36px;
      font-weight: 800;
      margin: 0 0 24px 0;
      text-align: center;
    }

    .panel-content {
      font-size: 18px;
      line-height: 1.7;
      margin-bottom: 32px;
    }

    .complete-btn {
      width: 100%;
      padding: 16px;
      font-size: 18px;
      font-weight: 700;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      background-color: #10b981;
      color: #ffffff;
    }

    .complete-btn:hover {
      background-color: #059669;
      transform: translateY(-2px);
    }

    .complete-btn.completed {
      background-color: rgba(16, 185, 129, 0.3);
      cursor: default;
    }

    .complete-btn.completed:hover {
      transform: none;
      background-color: rgba(16, 185, 129, 0.3);
    }

    .loading {
      opacity: 0.6;
      pointer-events: none;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container">
   <header class="hero-section">
    <h1 class="hero-title" id="hero-title">Master New Skills Today</h1>
    <p class="hero-subtitle" id="hero-subtitle">Unlock your potential with expert-led courses</p><button class="start-button" id="start-button" onclick="scrollToLessons()">Start Learning</button>
   </header>
   <div class="stats-bar">
    <div class="stat-item"><span class="stat-number" id="total-lessons">6</span> <span class="stat-label">Total Lessons</span>
    </div>
    <div class="stat-item"><span class="stat-number" id="completed-count">0</span> <span class="stat-label">Completed</span>
    </div>
    <div class="stat-item"><span class="stat-number" id="progress-percent">0%</span> <span class="stat-label">Progress</span>
    </div>
   </div>
   <main class="content-section">
    <h2 class="section-title" id="section-title">Available Courses</h2>
    <div class="lessons-container" id="lessons-container"></div>
   </main>
  </div>
  <div class="overlay" id="overlay">
   <div class="lesson-panel"><button class="close-btn" onclick="closeLesson()" aria-label="Close lesson">√ó</button>
    <h3 class="panel-title" id="panel-title"></h3>
    <div class="panel-content" id="panel-content"></div><button class="complete-btn" id="complete-btn" onclick="toggleComplete()"></button>
   </div>
  </div>
  <script>
    const defaultConfig = {
      hero_title: "Master New Skills Today",
      hero_subtitle: "Unlock your potential with expert-led courses",
      cta_button_text: "Start Learning",
      section_title: "Available Courses",
      background_color: "#0f172a",
      surface_color: "#1e293b",
      text_color: "#f1f5f9",
      primary_action_color: "#3b82f6",
      secondary_action_color: "#10b981",
      font_family: "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",
      font_size: 16
    };

    const lessons = [
      {
        id: "intro-web",
        emoji: "üåê",
        name: "Web Development Basics",
        info: "30 min ‚Ä¢ Beginner",
        description: "Learn the fundamentals of HTML, CSS, and JavaScript to build your first website. This course covers everything from basic HTML structure to styling with CSS and adding interactivity with JavaScript.",
        objectives: [
          "Understand HTML document structure and semantic tags",
          "Style web pages using CSS properties and selectors",
          "Add interactivity with JavaScript basics",
          "Build a complete responsive webpage from scratch"
        ],
        quiz: [
          {
            question: "What does HTML stand for?",
            options: ["Hyper Text Markup Language", "High Tech Modern Language", "Home Tool Markup Language", "Hyperlinks and Text Markup Language"],
            correct: 0
          },
          {
            question: "Which CSS property is used to change text color?",
            options: ["text-color", "font-color", "color", "text-style"],
            correct: 2
          },
          {
            question: "What is the correct syntax for referring to an external JavaScript file?",
            options: ["<script href='app.js'>", "<script name='app.js'>", "<script src='app.js'>", "<script file='app.js'>"],
            correct: 2
          }
        ]
      },
      {
        id: "design-101",
        emoji: "üé®",
        name: "Design Principles",
        info: "45 min ‚Ä¢ Intermediate",
        description: "Master color theory, typography, and layout to create stunning visual designs. Learn professional design techniques used by top designers worldwide.",
        objectives: [
          "Apply color theory to create harmonious palettes",
          "Choose and pair fonts effectively",
          "Create balanced layouts using grids",
          "Understand visual hierarchy and spacing"
        ],
        quiz: [
          {
            question: "What are complementary colors?",
            options: ["Colors next to each other on the color wheel", "Colors opposite each other on the color wheel", "Different shades of the same color", "Black and white"],
            correct: 1
          },
          {
            question: "Which principle refers to the arrangement of elements to guide the eye?",
            options: ["Contrast", "Alignment", "Visual Hierarchy", "Proximity"],
            correct: 2
          },
          {
            question: "What is the recommended maximum number of fonts in a design?",
            options: ["1-2", "2-3", "4-5", "As many as needed"],
            correct: 1
          }
        ]
      },
      {
        id: "data-science",
        emoji: "üìä",
        name: "Data Science Intro",
        info: "60 min ‚Ä¢ Beginner",
        description: "Explore data analysis, visualization, and basic machine learning concepts. Learn how to extract insights from data and make data-driven decisions.",
        objectives: [
          "Clean and prepare data for analysis",
          "Create meaningful data visualizations",
          "Understand statistical concepts and measures",
          "Introduction to machine learning algorithms"
        ],
        quiz: [
          {
            question: "What is the first step in the data science workflow?",
            options: ["Data Visualization", "Data Collection", "Model Building", "Data Cleaning"],
            correct: 1
          },
          {
            question: "Which chart type is best for showing trends over time?",
            options: ["Pie chart", "Line chart", "Bar chart", "Scatter plot"],
            correct: 1
          },
          {
            question: "What does 'mean' represent in statistics?",
            options: ["The middle value", "The most frequent value", "The average value", "The range of values"],
            correct: 2
          }
        ]
      },
      {
        id: "marketing",
        emoji: "üì±",
        name: "Digital Marketing",
        info: "40 min ‚Ä¢ Beginner",
        description: "Understand SEO, social media strategy, and content marketing fundamentals. Learn how to reach and engage your target audience effectively online.",
        objectives: [
          "Optimize content for search engines (SEO)",
          "Create engaging social media campaigns",
          "Develop content marketing strategies",
          "Measure and analyze marketing metrics"
        ],
        quiz: [
          {
            question: "What does SEO stand for?",
            options: ["Social Engine Optimization", "Search Engine Optimization", "System Entry Optimization", "Site Engagement Optimization"],
            correct: 1
          },
          {
            question: "Which metric measures user engagement on social media?",
            options: ["Impressions only", "Follower count only", "Likes, shares, and comments", "Profile views only"],
            correct: 2
          },
          {
            question: "What is a 'call-to-action' (CTA)?",
            options: ["A phone number", "A prompt encouraging users to take action", "A contact form", "A website menu"],
            correct: 1
          }
        ]
      },
      {
        id: "photography",
        emoji: "üì∑",
        name: "Photography Essentials",
        info: "50 min ‚Ä¢ Beginner",
        description: "Learn composition, lighting, and editing techniques for stunning photos. Master the art of capturing beautiful moments with professional techniques.",
        objectives: [
          "Master the rule of thirds and composition",
          "Understand exposure triangle (ISO, Aperture, Shutter Speed)",
          "Work with natural and artificial lighting",
          "Edit photos using professional techniques"
        ],
        quiz: [
          {
            question: "What is the 'rule of thirds' in photography?",
            options: ["Take three photos of each subject", "Divide the frame into nine equal parts", "Use three light sources", "Shoot at three different angles"],
            correct: 1
          },
          {
            question: "Which setting controls the amount of light entering the camera?",
            options: ["Focus", "Aperture", "White Balance", "Zoom"],
            correct: 1
          },
          {
            question: "What is 'golden hour' in photography?",
            options: ["The first hour of shooting", "One hour after sunrise or before sunset", "Any hour with good weather", "60 minutes of editing time"],
            correct: 1
          }
        ]
      },
      {
        id: "productivity",
        emoji: "‚ö°",
        name: "Productivity Hacks",
        info: "25 min ‚Ä¢ All Levels",
        description: "Discover time management strategies and tools to maximize your efficiency. Learn proven techniques to accomplish more in less time.",
        objectives: [
          "Implement the Pomodoro Technique",
          "Prioritize tasks using the Eisenhower Matrix",
          "Eliminate distractions and focus better",
          "Build sustainable productivity habits"
        ],
        quiz: [
          {
            question: "What is the Pomodoro Technique?",
            options: ["A cooking method", "25 minutes of focused work followed by a break", "A project management tool", "A meditation practice"],
            correct: 1
          },
          {
            question: "In the Eisenhower Matrix, which tasks should you do first?",
            options: ["Not urgent and not important", "Urgent but not important", "Important but not urgent", "Urgent and important"],
            correct: 3
          },
          {
            question: "What is 'time blocking'?",
            options: ["Blocking time-wasting websites", "Scheduling specific time slots for tasks", "Working without breaks", "Multitasking efficiently"],
            correct: 1
          }
        ]
      },
      {
        id: "python-basics",
        emoji: "üêç",
        name: "Python Programming",
        info: "55 min ‚Ä¢ Beginner",
        description: "Start your coding journey with Python, one of the most popular and versatile programming languages. Learn to write clean, efficient code.",
        objectives: [
          "Understand Python syntax and data types",
          "Work with lists, dictionaries, and functions",
          "Handle errors and exceptions properly",
          "Build practical Python applications"
        ],
        quiz: [
          {
            question: "Which symbol is used for comments in Python?",
            options: ["//", "#", "/*", "--"],
            correct: 1
          },
          {
            question: "What data type is [1, 2, 3, 4] in Python?",
            options: ["Tuple", "Dictionary", "List", "Set"],
            correct: 2
          },
          {
            question: "How do you define a function in Python?",
            options: ["function myFunc():", "def myFunc():", "func myFunc():", "define myFunc():"],
            correct: 1
          }
        ]
      },
      {
        id: "ui-ux",
        emoji: "‚ú®",
        name: "UI/UX Design",
        info: "50 min ‚Ä¢ Intermediate",
        description: "Create intuitive and delightful user experiences. Learn the principles of user interface and user experience design that make products people love.",
        objectives: [
          "Conduct user research and create personas",
          "Design wireframes and prototypes",
          "Apply usability principles and best practices",
          "Test and iterate on designs"
        ],
        quiz: [
          {
            question: "What does UX stand for?",
            options: ["User Extension", "Universal Experience", "User Experience", "Unified Exchange"],
            correct: 2
          },
          {
            question: "What is a wireframe?",
            options: ["A high-fidelity design", "A basic visual guide for layout", "A finished product", "A coding framework"],
            correct: 1
          },
          {
            question: "What is the goal of user research?",
            options: ["Make designs look pretty", "Understand user needs and behaviors", "Increase development time", "Reduce costs"],
            correct: 1
          }
        ]
      },
      {
        id: "blockchain",
        emoji: "‚õìÔ∏è",
        name: "Blockchain Fundamentals",
        info: "45 min ‚Ä¢ Advanced",
        description: "Understand the revolutionary technology behind cryptocurrencies and decentralized applications. Learn how blockchain is transforming industries.",
        objectives: [
          "Understand how blockchain technology works",
          "Learn about cryptocurrencies and tokens",
          "Explore smart contracts and DApps",
          "Identify blockchain use cases across industries"
        ],
        quiz: [
          {
            question: "What is a blockchain?",
            options: ["A type of cryptocurrency", "A distributed ledger technology", "A programming language", "A database software"],
            correct: 1
          },
          {
            question: "What ensures the security of blockchain?",
            options: ["Passwords", "Cryptography and consensus", "Firewalls", "Antivirus software"],
            correct: 1
          },
          {
            question: "What is a smart contract?",
            options: ["A legal document", "Self-executing code on blockchain", "A business agreement", "A payment method"],
            correct: 1
          }
        ]
      },
      {
        id: "public-speaking",
        emoji: "üé§",
        name: "Public Speaking Mastery",
        info: "40 min ‚Ä¢ All Levels",
        description: "Overcome stage fright and deliver powerful presentations. Build confidence and master the art of engaging any audience.",
        objectives: [
          "Overcome nervousness and build confidence",
          "Structure compelling presentations",
          "Use vocal variety and body language effectively",
          "Engage and persuade your audience"
        ],
        quiz: [
          {
            question: "What is the most important aspect of public speaking?",
            options: ["Speaking loudly", "Knowing your audience", "Using fancy words", "Standing still"],
            correct: 1
          },
          {
            question: "How can you reduce nervousness before speaking?",
            options: ["Avoid practice", "Deep breathing and preparation", "Think about failure", "Rush through the speech"],
            correct: 1
          },
          {
            question: "What is the '3-part structure' of a speech?",
            options: ["Beginning, middle, end", "Introduction, body, conclusion", "Title, content, questions", "Greeting, story, goodbye"],
            correct: 1
          }
        ]
      },
      {
        id: "financial-literacy",
        emoji: "üí∞",
        name: "Financial Literacy",
        info: "35 min ‚Ä¢ Beginner",
        description: "Take control of your finances with essential money management skills. Learn budgeting, saving, and smart investing strategies.",
        objectives: [
          "Create and maintain a personal budget",
          "Understand different types of investments",
          "Build an emergency fund and save effectively",
          "Make informed financial decisions"
        ],
        quiz: [
          {
            question: "What is the 50/30/20 budgeting rule?",
            options: ["50% savings, 30% needs, 20% wants", "50% needs, 30% wants, 20% savings", "50% wants, 30% savings, 20% needs", "All equal thirds"],
            correct: 1
          },
          {
            question: "What is compound interest?",
            options: ["Interest on the principal only", "Interest on principal and accumulated interest", "A bank fee", "A type of loan"],
            correct: 1
          },
          {
            question: "How many months of expenses should an emergency fund cover?",
            options: ["1-2 months", "3-6 months", "12 months", "24 months"],
            correct: 1
          }
        ]
      },
      {
        id: "mindfulness",
        emoji: "üßò",
        name: "Mindfulness & Meditation",
        info: "30 min ‚Ä¢ Beginner",
        description: "Reduce stress and increase focus through mindfulness practices. Learn meditation techniques for a calmer, more centered life.",
        objectives: [
          "Practice basic meditation techniques",
          "Develop mindful awareness in daily life",
          "Manage stress and anxiety effectively",
          "Improve focus and emotional regulation"
        ],
        quiz: [
          {
            question: "What is mindfulness?",
            options: ["Thinking about the future", "Being present in the moment", "Remembering the past", "Multitasking effectively"],
            correct: 1
          },
          {
            question: "How long should beginners meditate daily?",
            options: ["5-10 minutes", "1 hour", "3 hours", "All day"],
            correct: 0
          },
          {
            question: "What is 'breath awareness' meditation?",
            options: ["Holding your breath", "Focusing on natural breathing", "Breathing rapidly", "Counting breaths only"],
            correct: 1
          }
        ]
      }
    ];

    let userProgress = [];
    let currentLesson = null;
    let isUpdating = false;

    const dataHandler = {
      onDataChanged(data) {
        userProgress = data || [];
        renderLessons();
        updateStats();
        
        // Update panel if currently viewing a lesson
        if (currentLesson && document.getElementById('overlay').classList.contains('show')) {
          const progress = userProgress.find(p => p.lesson_id === currentLesson.id);
          const isCompleted = progress && progress.completed;
          const completeBtn = document.getElementById('complete-btn');
          completeBtn.textContent = isCompleted ? '‚úì Completed' : 'Mark as Complete';
          completeBtn.className = `complete-btn${isCompleted ? ' completed' : ''}`;
          
          const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
          if (!isCompleted) {
            completeBtn.style.backgroundColor = config.secondary_action_color || defaultConfig.secondary_action_color;
          }
        }
      }
    };

    async function init() {
      // Initial render immediately on page load
      renderLessons();
      updateStats();

      const initResult = await window.dataSdk.init(dataHandler);
      if (!initResult.isOk) {
        console.error("Failed to initialize data SDK");
        return;
      }

      await window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (config) => {
          document.getElementById('hero-title').textContent = config.hero_title || defaultConfig.hero_title;
          document.getElementById('hero-subtitle').textContent = config.hero_subtitle || defaultConfig.hero_subtitle;
          document.getElementById('start-button').textContent = config.cta_button_text || defaultConfig.cta_button_text;
          document.getElementById('section-title').textContent = config.section_title || defaultConfig.section_title;

          const customFont = config.font_family || defaultConfig.font_family;
          const baseFontStack = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
          document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;

          const baseSize = config.font_size || defaultConfig.font_size;
          document.querySelector('.hero-title').style.fontSize = `${baseSize * 3}px`;
          document.querySelector('.hero-subtitle').style.fontSize = `${baseSize * 1.25}px`;
          document.querySelector('.start-button').style.fontSize = `${baseSize * 1.125}px`;
          document.querySelector('.section-title').style.fontSize = `${baseSize * 1.75}px`;
          document.querySelector('.panel-title').style.fontSize = `${baseSize * 2.25}px`;
          document.querySelector('.panel-content').style.fontSize = `${baseSize * 1.125}px`;

          document.body.style.backgroundColor = config.background_color || defaultConfig.background_color;
          document.body.style.color = config.text_color || defaultConfig.text_color;
          
          document.querySelectorAll('.lesson-box, .lesson-panel').forEach(el => {
            el.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
            el.style.color = config.text_color || defaultConfig.text_color;
          });

          document.querySelectorAll('.start-button, .stat-number, .stats-bar').forEach(el => {
            if (el.classList.contains('start-button')) {
              el.style.backgroundColor = config.primary_action_color || defaultConfig.primary_action_color;
            } else if (el.classList.contains('stat-number')) {
              el.style.color = config.primary_action_color || defaultConfig.primary_action_color;
            } else if (el.classList.contains('stats-bar')) {
              el.style.borderTopColor = config.primary_action_color || defaultConfig.primary_action_color;
            }
          });

          document.querySelectorAll('.complete-btn').forEach(el => {
            if (!el.classList.contains('completed')) {
              el.style.backgroundColor = config.secondary_action_color || defaultConfig.secondary_action_color;
            }
          });

          renderLessons();
        },
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                window.elementSdk.config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.surface_color || defaultConfig.surface_color,
              set: (value) => {
                window.elementSdk.config.surface_color = value;
                window.elementSdk.setConfig({ surface_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                window.elementSdk.config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.primary_action_color || defaultConfig.primary_action_color,
              set: (value) => {
                window.elementSdk.config.primary_action_color = value;
                window.elementSdk.setConfig({ primary_action_color: value });
              }
            },
            {
              get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
              set: (value) => {
                window.elementSdk.config.secondary_action_color = value;
                window.elementSdk.setConfig({ secondary_action_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              window.elementSdk.config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              window.elementSdk.config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["hero_title", config.hero_title || defaultConfig.hero_title],
          ["hero_subtitle", config.hero_subtitle || defaultConfig.hero_subtitle],
          ["cta_button_text", config.cta_button_text || defaultConfig.cta_button_text],
          ["section_title", config.section_title || defaultConfig.section_title]
        ])
      });
    }

    function renderLessons() {
      const container = document.getElementById('lessons-container');
      if (!container) return;
      
      container.innerHTML = '';

      lessons.forEach(lesson => {
        const progress = userProgress.find(p => p.lesson_id === lesson.id);
        const isCompleted = progress && progress.completed;

        const lessonBox = document.createElement('div');
        lessonBox.className = `lesson-box${isCompleted ? ' completed' : ''}`;
        lessonBox.onclick = () => openLesson(lesson);
        
        const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
        lessonBox.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
        lessonBox.style.color = config.text_color || defaultConfig.text_color;

        lessonBox.innerHTML = `
          <span class="lesson-emoji">${lesson.emoji}</span>
          <div class="lesson-name">${lesson.name}</div>
          <div class="lesson-info">${lesson.info}</div>
          <span class="lesson-badge${isCompleted ? ' completed' : ''}">${isCompleted ? '‚úì Completed' : 'Start'}</span>
        `;

        container.appendChild(lessonBox);
      });
    }

    function updateStats() {
      const totalLessons = lessons.length;
      const completedCount = userProgress.filter(p => p.completed).length;
      const progressPercent = totalLessons > 0 ? Math.round((completedCount / totalLessons) * 100) : 0;

      document.getElementById('total-lessons').textContent = totalLessons;
      document.getElementById('completed-count').textContent = completedCount;
      document.getElementById('progress-percent').textContent = `${progressPercent}%`;
    }

    let currentQuizIndex = 0;
    let quizAnswers = [];
    let showingQuiz = false;

    function openLesson(lesson) {
      currentLesson = lesson;
      currentQuizIndex = 0;
      quizAnswers = [];
      showingQuiz = false;
      
      const progress = userProgress.find(p => p.lesson_id === lesson.id);
      const isCompleted = progress && progress.completed;

      document.getElementById('panel-title').textContent = lesson.name;
      
      let contentHTML = `
        <div style="margin-bottom: 24px;">
          <p style="margin-bottom: 20px; line-height: 1.7;">${lesson.description}</p>
          <h4 style="font-size: 18px; font-weight: 700; margin: 20px 0 12px 0;">Learning Objectives:</h4>
          <ul style="margin: 0; padding-left: 24px; line-height: 1.8;">
            ${lesson.objectives.map(obj => `<li style="margin-bottom: 8px;">${obj}</li>`).join('')}
          </ul>
        </div>
      `;
      
      document.getElementById('panel-content').innerHTML = contentHTML;
      
      const completeBtn = document.getElementById('complete-btn');
      if (isCompleted) {
        completeBtn.textContent = '‚úì Completed';
        completeBtn.className = 'complete-btn completed';
      } else {
        completeBtn.textContent = 'Take Quiz';
        completeBtn.className = 'complete-btn';
        const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
        completeBtn.style.backgroundColor = config.secondary_action_color || defaultConfig.secondary_action_color;
      }

      document.getElementById('overlay').classList.add('show');
    }

    function closeLesson() {
      document.getElementById('overlay').classList.remove('show');
      currentLesson = null;
    }

    function showQuiz() {
      if (!currentLesson || !currentLesson.quiz) return;
      
      showingQuiz = true;
      const quiz = currentLesson.quiz;
      const question = quiz[currentQuizIndex];
      
      const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
      
      let quizHTML = `
        <div style="margin-bottom: 24px;">
          <div style="font-size: 14px; opacity: 0.7; margin-bottom: 16px;">Question ${currentQuizIndex + 1} of ${quiz.length}</div>
          <h4 style="font-size: 20px; font-weight: 700; margin-bottom: 24px; line-height: 1.4;">${question.question}</h4>
          <div id="quiz-options" style="display: flex; flex-direction: column; gap: 12px;">
            ${question.options.map((option, index) => `
              <button 
                onclick="selectAnswer(${index})" 
                class="quiz-option" 
                data-index="${index}"
                style="
                  padding: 16px 20px;
                  border: 2px solid rgba(255, 255, 255, 0.2);
                  border-radius: 12px;
                  background: rgba(255, 255, 255, 0.05);
                  color: ${config.text_color || defaultConfig.text_color};
                  font-size: 16px;
                  cursor: pointer;
                  text-align: left;
                  transition: all 0.3s;
                  font-weight: 500;
                "
              >${option}</button>
            `).join('')}
          </div>
        </div>
      `;
      
      document.getElementById('panel-content').innerHTML = quizHTML;
      
      const completeBtn = document.getElementById('complete-btn');
      completeBtn.textContent = 'Next Question';
      completeBtn.style.display = 'none';
    }

    function selectAnswer(answerIndex) {
      if (!currentLesson || currentQuizIndex >= currentLesson.quiz.length) return;
      
      const question = currentLesson.quiz[currentQuizIndex];
      const isCorrect = answerIndex === question.correct;
      quizAnswers.push({ questionIndex: currentQuizIndex, answer: answerIndex, correct: isCorrect });
      
      const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
      const options = document.querySelectorAll('.quiz-option');
      
      options.forEach((option, index) => {
        option.style.pointerEvents = 'none';
        if (index === question.correct) {
          option.style.borderColor = config.secondary_action_color || defaultConfig.secondary_action_color;
          option.style.backgroundColor = `${config.secondary_action_color || defaultConfig.secondary_action_color}33`;
        } else if (index === answerIndex && !isCorrect) {
          option.style.borderColor = '#ef4444';
          option.style.backgroundColor = '#ef444433';
        }
      });
      
      const completeBtn = document.getElementById('complete-btn');
      completeBtn.style.display = 'block';
      
      if (currentQuizIndex < currentLesson.quiz.length - 1) {
        completeBtn.textContent = 'Next Question';
        completeBtn.onclick = nextQuestion;
      } else {
        completeBtn.textContent = 'View Results';
        completeBtn.onclick = showQuizResults;
      }
    }

    function nextQuestion() {
      currentQuizIndex++;
      showQuiz();
    }

    function showQuizResults() {
      const correctCount = quizAnswers.filter(a => a.correct).length;
      const totalQuestions = currentLesson.quiz.length;
      const percentage = Math.round((correctCount / totalQuestions) * 100);
      const passed = percentage >= 70;
      
      const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
      
      let resultsHTML = `
        <div style="text-align: center; padding: 20px;">
          <div style="font-size: 64px; margin-bottom: 16px;">${passed ? 'üéâ' : 'üìö'}</div>
          <h3 style="font-size: 28px; font-weight: 800; margin-bottom: 12px;">
            ${passed ? 'Congratulations!' : 'Keep Learning!'}
          </h3>
          <p style="font-size: 18px; margin-bottom: 24px; opacity: 0.9;">
            You scored ${correctCount} out of ${totalQuestions} (${percentage}%)
          </p>
          <div style="background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 24px; margin-bottom: 24px;">
            <div style="font-size: 16px; margin-bottom: 12px; opacity: 0.8;">
              ${passed ? 
                'Great job! You\'ve demonstrated understanding of the key concepts.' : 
                'You need 70% to pass. Review the material and try again!'}
            </div>
          </div>
        </div>
      `;
      
      document.getElementById('panel-content').innerHTML = resultsHTML;
      
      const completeBtn = document.getElementById('complete-btn');
      if (passed) {
        completeBtn.textContent = 'Complete Lesson';
        completeBtn.onclick = () => markAsComplete();
        completeBtn.style.backgroundColor = config.secondary_action_color || defaultConfig.secondary_action_color;
      } else {
        completeBtn.textContent = 'Retake Quiz';
        completeBtn.onclick = () => {
          currentQuizIndex = 0;
          quizAnswers = [];
          showQuiz();
        };
      }
    }

    async function markAsComplete() {
      if (!currentLesson || isUpdating) return;

      const progress = userProgress.find(p => p.lesson_id === currentLesson.id);
      const isCurrentlyCompleted = progress && progress.completed;

      if (isCurrentlyCompleted) return;

      isUpdating = true;
      const completeBtn = document.getElementById('complete-btn');
      completeBtn.classList.add('loading');
      completeBtn.textContent = 'Saving...';

      if (progress) {
        progress.completed = true;
        progress.completed_at = new Date().toISOString();
        const result = await window.dataSdk.update(progress);
        
        if (!result.isOk) {
          completeBtn.textContent = 'Error - Try Again';
          completeBtn.classList.remove('loading');
          isUpdating = false;
          return;
        }
      } else {
        const result = await window.dataSdk.create({
          lesson_id: currentLesson.id,
          completed: true,
          completed_at: new Date().toISOString()
        });

        if (!result.isOk) {
          completeBtn.textContent = 'Error - Try Again';
          completeBtn.classList.remove('loading');
          isUpdating = false;
          return;
        }
      }

      completeBtn.textContent = '‚úì Lesson Completed!';
      completeBtn.classList.remove('loading');
      completeBtn.classList.add('completed');
      isUpdating = false;
      
      setTimeout(() => {
        closeLesson();
      }, 1500);
    }

    async function toggleComplete() {
      if (!currentLesson || isUpdating) return;

      const progress = userProgress.find(p => p.lesson_id === currentLesson.id);
      const isCurrentlyCompleted = progress && progress.completed;

      if (isCurrentlyCompleted) return;

      if (!showingQuiz) {
        showQuiz();
      }
    }

    function scrollToLessons() {
      document.querySelector('.content-section').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
      });
    }

    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a2e14fef5fb2992',t:'MTc2Mzg3MzgwNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
